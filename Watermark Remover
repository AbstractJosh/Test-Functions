using DocumentFormat.OpenXml.Packaging;
using OpenXmlPowerTools;

public static class DocxCleaner
{
    public static void RemoveTextFromDocument(string filePath, string textToRemove = "placeholder")
    {
        // Load the Word file into memory
        var doc = new WmlDocument(filePath);

        // Simplify markup first (merges split runs, removes unnecessary tags)
        doc = WmlDocumentExtensions.SimplifyMarkup(doc,
            new SimplifyMarkupSettings
            {
                RemoveBookmarks = true,
                RemoveComments = true,
                RemoveFieldCodes = false,
                RemoveLastRenderedPageBreak = true,
                RemovePermissions = true,
                RemoveProof = true,
                RemoveRsidInfo = true,
                RemoveSmartTags = true,
                RemoveSoftHyphens = true
            });

        // Replace the text everywhere in the document
        doc = TextReplacer.SearchAndReplace(doc, textToRemove, "", false); 
        // last param = case-sensitive (true) / case-insensitive (false)

        // Save back to same path
        doc.SaveAs(filePath);
    }
}
